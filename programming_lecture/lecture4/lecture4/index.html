<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="浙江大学竺可桢学院辅学计划站点" name="description"/>
<meta content="竺可桢学院学业指导中心" name="author"/>
<link href="https://ckc-agc.pages.zjusct.io/study-assist/programming_lecture/lecture4/lecture4/" rel="canonical"/>
<link href="../../lecture3/lecture3/" rel="prev"/>
<link href="../../lecture5/lecture5/" rel="next"/>
<link href="../../../graph/ckc.png" rel="icon"/>
<meta content="mkdocs-1.5.3, mkdocs-material-9.4.9" name="generator"/>
<title>C 标准库 - 浙江大学竺可桢学院辅学计划站点</title>
<link href="../../../assets/stylesheets/main.78cf6014.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.356b1318.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../../css/heti.css" rel="stylesheet"/>
<link href="../../../stylesheets/neoteroi-mkdocs.css" rel="stylesheet"/>
<link href="../../../stylesheets/custom.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#c">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="浙江大学竺可桢学院辅学计划站点" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="浙江大学竺可桢学院辅学计划站点">
<img alt="logo" src="../../../graph/ckc.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            浙江大学竺可桢学院辅学计划站点
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              C 标准库
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="indigo" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
</label>
</form>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/ckc-agc/study-assist" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</div>
<div class="md-source__repository">
    浙江大学竺可桢学院辅学计划站点
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../..">
          
  
    
  
  首页

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../calculus/">
          
  
    
  
  📚微积分

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../analysis/">
          
  
    
  
  📚数学分析

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../algebra/">
          
  
    
  
  📚线性代数

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../lalu/">
          
  
    
  
  🏫线性代数：未竟之美

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../programming/">
          
  
    
  
  📚程序设计

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="https://slides.tonycrane.cc/PracticalSkillsTutorial/2023-fall-ckc/#/">
        
  
    
  
  🏫实用技能拾遗

      </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../../">
          
  
    
  
  🏫系统知识拾遗

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../chemistry/">
          
  
    
  
  📚普通化学

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../physics/">
          
  
    
  
  📚普通物理学

        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="浙江大学竺可桢学院辅学计划站点" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="浙江大学竺可桢学院辅学计划站点">
<img alt="logo" src="../../../graph/ckc.png"/>
</a>
    浙江大学竺可桢学院辅学计划站点
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/ckc-agc/study-assist" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</div>
<div class="md-source__repository">
    浙江大学竺可桢学院辅学计划站点
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_1" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../..">
<span class="md-ellipsis">
    首页
  </span>
</a>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
            首页
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../test/">
<span class="md-ellipsis">
    测试
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../../calculus/">
<span class="md-ellipsis">
    📚微积分
  </span>
</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            📚微积分
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../../analysis/">
<span class="md-ellipsis">
    📚数学分析
  </span>
</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            📚数学分析
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../../algebra/">
<span class="md-ellipsis">
    📚线性代数
  </span>
</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            📚线性代数
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../../lalu/">
<span class="md-ellipsis">
    🏫线性代数：未竟之美
  </span>
</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            🏫线性代数：未竟之美
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../../programming/">
<span class="md-ellipsis">
    📚程序设计
  </span>
</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            📚程序设计
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://slides.tonycrane.cc/PracticalSkillsTutorial/2023-fall-ckc/#/">
<span class="md-ellipsis">
    🏫实用技能拾遗
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_8" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../">
<span class="md-ellipsis">
    🏫系统知识拾遗
  </span>
</a>
<label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_8_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_8">
<span class="md-nav__icon md-icon"></span>
            🏫系统知识拾遗
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../lecture1/pre_class/">
<span class="md-ellipsis">
    1. 程序编译过程与调试技术
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../lecture2/pre_class/">
<span class="md-ellipsis">
    2. 类型系统与内存模型
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../lecture3/pre_class/">
<span class="md-ellipsis">
    3. I/O 与文件
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_8_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_8_5" id="__nav_8_5_label" tabindex="0">
<span class="md-ellipsis">
    4. C 标准库
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_8_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_8_5">
<span class="md-nav__icon md-icon"></span>
            4. C 标准库
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    C 标准库
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    C 标准库
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#c_1">
<span class="md-ellipsis">
      前半：C 标准库的使用
    </span>
</a>
<nav aria-label="前半：C 标准库的使用" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ctypeh">
<span class="md-ellipsis">
      ctype.h
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#c_2">
<span class="md-ellipsis">
      后半：C 标准库的实现
    </span>
</a>
<nav aria-label="后半：C 标准库的实现" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#c_3">
<span class="md-ellipsis">
      杂项：C 标准对库的实现要求
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ctypeh_1">
<span class="md-ellipsis">
      &lt;ctype.h&gt; 的实现：宏与位运算
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#stdioh">
<span class="md-ellipsis">
      &lt;stdio.h&gt; 的实现：系统调用与内核编程
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../lecture5/lecture5/">
<span class="md-ellipsis">
    5. 数据结构与算法
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_9" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../../chemistry/">
<span class="md-ellipsis">
    📚普通化学
  </span>
</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_9_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_9">
<span class="md-nav__icon md-icon"></span>
            📚普通化学
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_10" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../../physics/">
<span class="md-ellipsis">
    📚普通物理学
  </span>
</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_10_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_10">
<span class="md-nav__icon md-icon"></span>
            📚普通物理学
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#c_1">
<span class="md-ellipsis">
      前半：C 标准库的使用
    </span>
</a>
<nav aria-label="前半：C 标准库的使用" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ctypeh">
<span class="md-ellipsis">
      ctype.h
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#c_2">
<span class="md-ellipsis">
      后半：C 标准库的实现
    </span>
</a>
<nav aria-label="后半：C 标准库的实现" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#c_3">
<span class="md-ellipsis">
      杂项：C 标准对库的实现要求
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ctypeh_1">
<span class="md-ellipsis">
      &lt;ctype.h&gt; 的实现：宏与位运算
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#stdioh">
<span class="md-ellipsis">
      &lt;stdio.h&gt; 的实现：系统调用与内核编程
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/ckc-agc/study-assist/tree/master/docs/programming_lecture/lecture4/lecture4.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"></path></svg>
</a>
<h1 id="c"><span>C<span class="heti-spacing"> </span></span>标准库<a class="headerlink" href="#c" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h1>
<!-- prettier-ignore-start -->
<div class="admonition danger">
<p class="admonition-title">施工中</p>
<p>本页面正在编辑中。</p>
</div>
<div class="admonition abstract">
<p class="admonition-title">摘要</p>
<ul>
<li>
<p>前半：<span>C<span class="heti-spacing"> </span></span>标准库的使用（简单）</p>
<p>前半部分的内容要求仅限于考试。从历年卷中看，考察内容仅限于：</p>
<ul>
<li><code>ctype.h</code>：在第二讲「类型系统与内存模型」提及</li>
<li><code>stdio.h</code>：已在第三讲「<span>I/O<span class="heti-spacing"> </span></span>与文件」介绍其中部分</li>
<li><code>string.h</code>：字符串相关操作</li>
<li><code>stdlib.h</code>：常用工具库</li>
<li><code>math.h</code>：数学库</li>
</ul>
<p>前半节课我们将对考试必备的标准库函数作介绍，用一个个案例展示它们的用法。</p>
</li>
<li>
<p>后半：<span>C<span class="heti-spacing"> </span></span>标准库的实现（较难）</p>
<p>后半部分我们将认识一下<span class="heti-skip"><span class="heti-spacing"> </span>C<span class="heti-spacing"> </span></span>标准库这类应用于生产环境的代码的组织方式，挑选一些经典的函数看看它的实现。这部分内容不会出现在考试中，但是对于理解<span class="heti-skip"><span class="heti-spacing"> </span>C<span class="heti-spacing"> </span></span>语言的底层实现有很大的帮助。或许它是你从未了解过的<span class="heti-skip"><span class="heti-spacing"> </span>C<span class="heti-spacing"> </span></span>语言的另一面。</p>
</li>
</ul>
</div>
<!-- prettier-ignore-end -->
<h2 id="c_1">前半：<span>C<span class="heti-spacing"> </span></span>标准库的使用<a class="headerlink" href="#c_1" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h2>
<p>「内容」 模块中代码段内被注释掉的内容，表示不作要求。</p>
<h3 id="ctypeh"><code>ctype.h</code><a class="headerlink" href="#ctypeh" title="Permanent link">¶</a></h3>
<!-- prettier-ignore-start -->
<div class="admonition info">
<p class="admonition-title">背景知识</p>
<p><span>ASCII<span class="heti-spacing"> </span></span>中：</p>
<ul>
<li>打印字符：<code>0x20</code> ~ <code>0x7E</code></li>
<li>控制字符：<code>0x00</code> <span>~<span class="heti-spacing"> </span></span><code>0x1F</code>和 <code>0x7F</code></li>
</ul>
</div>
<!-- prettier-ignore-end -->
<p>头文件 <code>&lt;ctype.h&gt;</code> 声明了几个可以用于<strong>识别和转换字符</strong>的函数。</p>
<h4 id="_1">内容<a class="headerlink" href="#_1" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h4>
<ul>
<li>字符判断函数
    <div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">isalnum</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="p">);</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">isalpha</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="p">);</span>
<span class="c1">// int iscntrl(int c);</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">isdigit</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="p">);</span>
<span class="c1">// int isgraph(int c);</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">islower</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="p">);</span>
<span class="c1">// int isprint(int c);</span>
<span class="c1">// int ispunct(int c);</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">isspace</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="p">);</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">isupper</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="p">);</span>
<span class="c1">// int isxdigit(int c);</span>
</code></pre></div></li>
<li>字符转换函数
    <div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">tolower</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="p">);</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">toupper</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="p">);</span>
</code></pre></div></li>
</ul>
<h4 id="_2">使用<a class="headerlink" href="#_2" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h4>
<p><code>&lt;ctype.h&gt;</code> 中的函数对<span class="heti-skip"><span class="heti-spacing"> </span>ASCII<span class="heti-spacing"> </span></span>字符大致作了如下划分：</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../graph/character_types.png"><img alt="" src="../graph/character_types.png"/></a></p>
<h2 id="c_2">后半：<span>C<span class="heti-spacing"> </span></span>标准库的实现<a class="headerlink" href="#c_2" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h2>
<!-- prettier-ignore-start -->
<div class="admonition info">
<p class="admonition-title">杂谈：为什么要学习<span class="heti-skip"><span class="heti-spacing"> </span>C<span class="heti-spacing"> </span></span>标准库？</p>
<p>理论上，学习完任何编程语言的基本语法后，我们就可以用它来编程解决任何实际问题了。但是，语言所衍生出的任何能提高生产力的库，其重要性往往会远远超过该语言本身。学习一门语言并学习其库的实现，这样才能熟练地驾驭语言工具，了解库所提供的功能和局限性，进而在特定的应用要求下扩展库。</p>
<p>尽管<span class="heti-skip"><span class="heti-spacing"> </span>C<span class="heti-spacing"> </span></span>语言及其所附带的标准库中隐藏着太多的晦涩陷阱，但我们不得不花大力气“过分钻研”它。学习<span class="heti-skip"><span class="heti-spacing"> </span>C<span class="heti-spacing"> </span></span>标准库本身的实现，就是学习<span class="heti-skip"><span class="heti-spacing"> </span>C<span class="heti-spacing"> </span></span>语言最好的教材，因为其实现过程将会把使用<span class="heti-skip"><span class="heti-spacing"> </span>C<span class="heti-spacing"> </span></span>语言编写具有工业强度的健壮代码所需的技巧展现得淋漓尽致。</p>
<p><span>C<span class="heti-spacing"> </span></span>标准库可以分为<span class="heti-skip"><span class="heti-spacing"> </span>3<span class="heti-spacing"> </span></span>组。如何正确和熟练地使用它们，可以相应地区分出<span class="heti-skip"><span class="heti-spacing"> </span>3<span class="heti-spacing"> </span></span>种层次的<span class="heti-skip"><span class="heti-spacing"> </span>C<span class="heti-spacing"> </span></span>程序员：</p>
<ul>
<li>合格程序员：
    <div class="highlight"><pre><span></span><code>&lt;ctype.h&gt; &lt;stdio.h&gt; &lt;stdlib.h&gt; &lt;string.h&gt;
</code></pre></div></li>
<li>熟练程序员：
    <div class="highlight"><pre><span></span><code>&lt;assert.h&gt; &lt;limits.h&gt; &lt;stddef.h&gt; &lt;time.h&gt;
</code></pre></div></li>
<li>优秀程序员：
    <div class="highlight"><pre><span></span><code>&lt;float.h&gt; &lt;math.h&gt; &lt;error.h&gt; &lt;locale.h&gt; &lt;setjmp.h&gt; &lt;signal.h&gt; &lt;stdarg.h&gt;
</code></pre></div></li>
</ul>
<p>可以看到，<span>C<span class="heti-spacing"> </span></span>程序设计这门课程对大家的要求就是「合格程序员<heti-adjacent class="heti-adjacent-half">」</heti-adjacent>。我们在课程中的极少部分代码会看见 <code>&lt;assert.h&gt;</code> 和 <code>&lt;time.h&gt;</code>，这两个库也会对你的编程有所帮助，优秀的同学可以以「熟练程序员」来要求自己。今后大多数同学或许都会转向学习<span><span class="heti-spacing"> </span>C++</span>，大概只有做安全、系统、嵌入式之类的同学会需要做到「优秀程序员」的地步。</p>
</div>
<div class="admonition tip">
<p class="admonition-title">学习<span class="heti-skip"><span class="heti-spacing"> </span>C<span class="heti-spacing"> </span></span>标准库前你应该具备的知识</p>
<ul>
<li>字符串、数组、指针等操作</li>
<li>命名空间：库中定义了<span class="heti-skip"><span class="heti-spacing"> </span>200<span class="heti-spacing"> </span></span>个以上的名字，你应当知道<span class="heti-skip"><span class="heti-spacing"> </span>C<span class="heti-spacing"> </span></span>中各种名字会如何被解析。</li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../graph/namespace.png"><img alt="" src="../graph/namespace.png"/></a></p>
</div>
<!-- prettier-ignore-end -->
<p>学习<span class="heti-skip"><span class="heti-spacing"> </span>C<span class="heti-spacing"> </span></span>标准库时，我们会接触到很多<span class="heti-skip"><span class="heti-spacing"> </span>C<span class="heti-spacing"> </span></span>标准中的规范性的严谨地语句，初读时可能让你觉得非常拗口和难以理解，让我们来读几条。</p>
<h3 id="c_3">杂项：<span>C<span class="heti-spacing"> </span></span>标准对库的实现要求<a class="headerlink" href="#c_3" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h3>
<p>标准库中的一些函数，可能同时提供了宏和函数的版本。</p>
<ul>
<li>一个实现必须为每一个库函数提供一个实际的函数，即使它已经为该函数提供了一个宏。</li>
<li>一个函数的任何宏定义都可以通过用括号把函数的名字括住来局部地抑制它。因为这个名字后面没有跟着指示一个宏函数名展开地左括号。</li>
<li>用来移除任何宏定义的 <code>#undef</code> 预处理指令的使用也可以保证实际函数的引用。</li>
</ul>
<!-- prettier-ignore-start -->
<div class="admonition example">
<p class="admonition-title"><code>atoi()</code> 的使用方式</p>
<ol>
<li>可能生成一个宏函数：
    <div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">str</span><span class="p">;</span>
<span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">atoi</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
</code></pre></div></li>
<li>生成一个实际函数引用：
    <div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="cp">#undef atoi</span>
<span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">str</span><span class="p">;</span>
<span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">atoi</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
</code></pre></div>
    或者
    <div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">str</span><span class="p">;</span>
<span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">atoi</span><span class="p">)(</span><span class="n">str</span><span class="p">);</span>
</code></pre></div></li>
</ol>
</div>
<!-- prettier-ignore-end -->
<h3 id="ctypeh_1"><code>&lt;ctype.h&gt;</code> 的实现：宏与位运算<a class="headerlink" href="#ctypeh_1" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h3>
<!-- prettier-ignore-start -->
<div class="admonition question">
<p class="admonition-title">🤚停一停，先别看下面的内容。思考一下，你会怎么实现上面的那些函数？</p>
<p>你会不会在想这样的代码：</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">isalnum</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="cm">/* test for alphanumeric character */</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">((</span><span class="sc">'0'</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="sc">'9'</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
<span class="w">            </span><span class="p">(</span><span class="sc">'a'</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="sc">'z'</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
<span class="w">            </span><span class="p">(</span><span class="sc">'A'</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="sc">'Z'</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
</div>
<!-- prettier-ignore-end -->
<p><code>&lt;ctype.h&gt;</code> 中的函数通常使用宏来实现。使用宏实现时需要注意以下因素：</p>
<ul>
<li>虽然宏可能比函数快，但是它们通常会产生更大的代码。如果在很多地方扩展，这个程序可能大到让你无法想象。</li>
<li>
<p>宏的参数可能会被求值多次，具有副作用的宏参数会导致意外。
    <!-- prettier-ignore-start --></p>
<div class="admonition warning">
<p class="admonition-title">会产生不安全行为的宏</p>
<p>标准库中，只有 <code>getc</code> 和 <code>putc</code> 可能会产生这种不安全行为。</p>
</div>
<!-- prettier-ignore-end -->
</li>
</ul>
<p><code>&lt;ctype.h&gt;</code> 中定义了一个查找表 <code>_Ctype</code>，两个映射表 <code>_Tolower</code> 和 <code>_Toupper</code>。每个字符都被编入查找表中，使用位运算就能判断出字符的类型。</p>
<div class="highlight"><span class="filename">ctype.h</span><pre><span></span><code><span class="cp">#define _DI 0x20 </span><span class="cm">/* '0'-'9' */</span>
<span class="cp">#define _LO 0x10 </span><span class="cm">/* 'a'-'z' */</span>
<span class="cp">#define _UP 0x02 </span><span class="cm">/* 'A'-'Z' */</span>
<span class="cp">#define _XA 0x200 </span><span class="cm">/* 'a'-'z', 'A'-'Z' */</span>
<span class="k">extern</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="o">*</span><span class="n">_Ctype</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">_Tolower</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">_Toupper</span><span class="p">;</span>
<span class="cp">#define isalnum(c) (_Ctype[(int)(c)] &amp; (_DI|_LO|_UP|_XA))</span>
<span class="cp">#define tolower(c) _ToLower[(int)(c)]</span>
</code></pre></div>
<!-- prettier-ignore-start -->
<div class="admonition question">
<p class="admonition-title">读一下上面的代码，想象一下 <code>_Ctype</code> 这个查找表的样子。</p>
</div>
<div class="admonition question">
<p class="admonition-title">考考你，对于<span class="heti-skip"><span class="heti-spacing"> </span>ASCII<span class="heti-spacing"> </span></span>字符集，这个查找表有多大？</p>
</div>
<div class="admonition question">
<p class="admonition-title">你能想一想映射表的实现吗？</p>
</div>
<!-- prettier-ignore-end -->
<p>同样，给出函数版本的实现：</p>
<div class="highlight"><span class="filename">isalnum.c</span><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ctype.h&gt;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">isalnum</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="cm">/* test for alphanumeric character */</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">_Ctype</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">_DI</span><span class="o">|</span><span class="n">_LO</span><span class="o">|</span><span class="n">_UP</span><span class="o">|</span><span class="n">_XA</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<p>下面两幅图分别展示了 <code>_Ctype</code> 和 <code>_Toupper</code> 的样子：</p>
<!-- prettier-ignore-start -->
<div class="nt-cards nt-grid cols-2">
<div class="nt-card">
<div class="nt-card-wrap">
<div>
<div class="nt-card-image tags"><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../graph/ctype.png"><img src="../graph/ctype.png"/></a></div>
<div class="nt-card-content">
<p class="nt-card-title"><code>_Ctype</code></p>
</div>
</div>
</div>
</div>
<div class="nt-card">
<div class="nt-card-wrap">
<div>
<div class="nt-card-image tags"><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="../graph/toupper.png"><img src="../graph/toupper.png"/></a></div>
<div class="nt-card-content">
<p class="nt-card-title"><code>_Toupper</code></p>
</div>
</div>
</div>
</div>
</div>
<!-- prettier-ignore-end -->
<p>非常地简单，对吧？这可比 <code>'a' &lt;= c &amp;&amp; c &lt;= 'z'</code> 这样的判断要快得多。于是我们学完了 <code>&lt;ctype.h&gt;</code> 的实现。</p>
<h3 id="stdioh"><code>&lt;stdio.h&gt;</code> 的实现：系统调用与内核编程<a class="headerlink" href="#stdioh" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h3>
<p>在我个人看来，<code>&lt;stdio.h&gt;</code> 的实现最具挑战性。你需要对实现对应的操作系统有一定的了解，才能编写出完善的代码。</p>
<!-- prettier-ignore-start -->
<div class="admonition tip">
<p class="admonition-title">本节以<span class="heti-skip"><span class="heti-spacing"> </span>UNIX<span class="heti-spacing"> </span></span>和<span class="heti-skip"><span class="heti-spacing"> </span>POSIX<span class="heti-spacing"> </span></span>规范的系统调用为准。</p>
</div>
<details class="info">
<summary>一些历史的背景：文件、设备和 <code>ioctl</code></summary>
<ol>
<li>混乱的磁盘文件系统</li>
</ol>
<p>或许你很难想象，<span>UNIX<span class="heti-spacing"> </span></span>之前的磁盘文件系统为文件赋予了很多类型上的概念和、作了很多区分，而不是我们现在所广泛接受的「文件就是一系列连续的字节」的概念。这边有一段描述，你可以看看：</p>
<blockquote>
<p>Typically source code was a distinguished type, different from data. Compilers could read source, compiled programs could read and write 'data.' Thus the creation and inspection of Fortran programs was often walled off from the creation and inspection of other files, with completely different ways to edit and print them. This ruled out the use of programs to generate (or even simply copy) Fortran programs.</p>
</blockquote>
<ol start="2">
<li>不统一的文本表示和设备交互</li>
</ol>
<p>早期程序的输入输出无法独立于设备。比如，在上个世纪<span class="heti-skip"><span class="heti-spacing"> </span>60<span class="heti-spacing"> </span></span>年代的<span class="heti-skip"><span class="heti-spacing"> </span>FORTRAN IV<span class="heti-spacing"> </span></span>中，在磁带机上需要用 <code>READ INPUT TAPE 5</code>，读取磁盘上需要用 <code>READ INPUT DISK 1</code>。这样的代码在不同的设备上需要修改，非常不方便。<span>UNIX<span class="heti-spacing"> </span></span>将这些混乱的设备交互封装在<strong>设备处理程序</strong>中。在<span class="heti-skip"><span class="heti-spacing"> </span>UNIX<span class="heti-spacing"> </span></span>系统看来，外围设备有三种类型：字符设备（Character devices<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>、块设备（Block devices）和网络设备（Network devices<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。这三种设备都被抽象为文件，使用统一的文件操作接口。</p>
<p>在<span class="heti-skip"><span class="heti-spacing"> </span>Ken Thompson<span class="heti-spacing"> </span></span>为<span class="heti-skip"><span class="heti-spacing"> </span>UNIX<span class="heti-spacing"> </span></span>设计统一的内部文本形式前，文本表示也是十分混乱的。结束一行是使用回车还是回车加换行，还是换行符，还是更神奇的字符？终端能不能识别和展开制表符？怎样用键盘标志文件结束？这些问题的答案和终端的生产厂商一样多。<span>UNIX<span class="heti-spacing"> </span></span>使用系统调用 <code>ioctl</code> 来设置一个设备的各种参数，负责对内部换行约定和各种终端之间的需要转换的字符进行处理。</p>
</details>
<!-- prettier-ignore-end -->
<hr/>
<div class="md-source-file">
<small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">November 18, 2023</span>
</small>
</div>
</article>
</div>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["search.highlight", "navigation.tracking", "navigation.tabs", "navigation.prune", "navigation.indexes", "navigation.top", "header.autohide", "content.code.copy", "content.code.annotate", "content.action.edit"], "search": "../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../../assets/javascripts/bundle.6c14ae12.min.js"></script>
<script src="../../../javascripts/mathjax.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script src="https://jsd.onmicrosoft.cn/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>